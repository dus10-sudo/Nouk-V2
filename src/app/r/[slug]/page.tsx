import { listThreads, createThread, getRoomBySlug } from '@/lib/api';import Link from 'next/link';import { revalidatePath } from 'next/cache';export const dynamic='force-dynamic';export default async function Page({params}:{params:{slug:string}}){const room=await getRoomBySlug(params.slug);if(!room)return <div className='app-card p-6'>Room not found.</div>;const {data:threads}=await listThreads(room.id);async function create(formData:FormData){'use server';const title=String(formData.get('title')||'').slice(0,140);await createThread(room.id,title);revalidatePath(`/r/${room.slug}`);}return(<div className='grid md:grid-cols-[280px,1fr] gap-6'><aside className='app-card p-4 h-fit'><h2 className='text-lg font-semibold mb-3'>Rooms</h2><Link href='/' className='text-sm underline'>← All rooms</Link></aside><section className='space-y-4'><div className='app-card p-6'><h1 className='text-2xl font-serif mb-1'>{room.title}</h1><p className='opacity-75'>{room.description}</p></div><form action={create} className='app-card p-4 flex items-center gap-3'><input name='title' placeholder='Start a new Nouk…' required className='flex-1 px-3 py-2 rounded-lg bg-white/70 dark:bg-black/20 border border-black/10 focus-ring'/><button className='px-4 py-2 rounded-lg bg-accent text-white font-medium shadow-soft'>Start</button></form><div className='grid gap-3'>{threads?.map(t=>(<Link key={t.id} href={`/t/${t.id}`} className='app-card p-4 hover:shadow-md transition-shadow'><div className='flex items-center justify-between'><div className='font-medium'>{t.title}</div><span className='text-xs opacity-70'>expires {new Date(t.expires_at).toLocaleString()}</span></div></Link>))||<div className='opacity-60 text-sm'>No threads yet.</div>}</div></section></div>);}